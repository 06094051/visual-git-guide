% vim: set fo=tcqw :
\documentclass[12pt]{article}
\usepackage[latin1]{inputenc}
\usepackage{cmbright}
\usepackage{tikz}
\usetikzlibrary{shapes,arrows,shadows,positioning}

\tikzset{basic/.style = {rectangle, text width=3.5cm, text centered,
rounded corners, minimum height=1cm, line width=2pt}}

\colorlet{HEAD}{gray!50}
\colorlet{branch}{orange!50}
\colorlet{commit}{green!50}
\colorlet{index}{blue!40}
\colorlet{work}{red!40}
\colorlet{old HEAD}{HEAD!50}
\colorlet{old branch}{branch!50}

\tikzset{history/.style = {basic, fill=commit!40, draw=commit}}
\tikzset{index/.style = {basic, fill=index!50, draw=index}}
\tikzset{work/.style = {basic, fill=work!50, draw=work}}

\tikzset{commit/.style = {history, text width=1.5cm, minimum height=.75cm}}
\tikzset{branch/.style = {commit, fill=branch!50, draw=branch}}
\tikzset{HEAD/.style = {commit, fill=HEAD!50, draw=HEAD}}
\tikzset{old branch/.style = {commit, fill=old branch!50, draw=old branch,
text=black!30}}
\tikzset{old HEAD/.style = {commit, fill=old HEAD!50, draw=old HEAD,
text=black!30}}

\tikzset{line/.style = {->, >=stealth', line width=1pt, color=black!70,
auto=right, bend right}}
\tikzset{object line/.style = {->, >=stealth, line width=.9pt}}
\tikzset{commit line/.style = {object line, color=commit}}
\tikzset{HEAD line/.style = {object line, color=HEAD}}
\tikzset{branch line/.style = {object line, color=branch}}
\tikzset{old HEAD line/.style = {object line, color=old HEAD}}
\tikzset{old branch line/.style = {object line, color=old branch}}
\tikzset{cancel ref/.style = {cross out, draw=black!70, line width=1pt}}

\tikzset{cmd/.style = {color=black, font={\ttfamily}}}

\tikzset{main/.style = {node distance = 2cm, bend angle=35}}

\newcommand\historynode[1][0,0]{\node [history] (head) at (#1) {History};}
\newcommand\indexnode[1][0,-1.5]{\node [index] (index) at (#1) {Stage (Index)};}
\newcommand\worknode[1][0,-3]{\node [work] (work) at (#1) {Working Directory};}
\newcommand\commitnodeA[1][-1,0]{\node [commit] (c1) at (#1) {3a985};}
\newcommand\commitnodeB[1][ 1,0]{\node [commit] (c2) at (#1) {b10b9};}
\newcommand\commitnodeC[1][ 3,0]{\node [commit] (c3) at (#1) {3325c};}
\newcommand\commitnodeD[1][ 5,0]{\node [commit] (c4) at (#1) {947c3};}
\newcommand\commits{\commitnodeA\commitnodeB\commitnodeC\commitnodeD
    \path [commit line]
        (c1) edge (c2)
        (c2) edge (c3)
        (c3) edge (c4)
        (c4) edge (6.2,0)
        ;}

\def\ref [#1] "#2" : #3 -> #4;{
    \node [#1, above=.4cm of #4] (#3) {#2};
    \path [#1 line] (#3) edge (#4);
    }
\def\oldref [#1] "#2" : #3 -> #4;{
    \ref [old #1] "#2" : old #3 -> #4;
    \node [cancel ref, above=.2cm of #4, anchor=center] {};
    }

\def\branch #1 -> #2;{\ref [branch] "#1" : #1 -> #2;}
\def\oldbranch #1 -> #2;{\oldref [branch] "#1" : #1 -> #2;}

\def\HEAD -> #1;{\node [HEAD, above=0cm of #1] (HEAD) {HEAD};}
\def\oldHEAD -> #1;{\node [old HEAD, above=0cm of #1] (old HEAD) {HEAD};}

\def\detachedHEAD -> #1;{\ref [HEAD] "HEAD" : HEAD -> #1;}
\def\olddetachedHEAD -> #1;{\oldref [HEAD] "HEAD" : HEAD -> #1;}

\begin{document}
\pagestyle{empty}
